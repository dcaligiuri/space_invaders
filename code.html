<!DOCTYPE html>
<html>
  <head> 
    <title>
      Space Invaders!
    </title>
  </head>

<body>

<canvas id="myCanvas" width="500" height="500" style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>


<img id="alien" src="alien1.jpg">
<img id="ship" src ="ship1.png">
<img id="missile" src="missile.png">
<img id="base" src ="base.png">





<script>

var lives = 3;
var score = 0;
var widthBoard = 500; 
var lengthBoard = 500;
var base = document.getElementById("base");
var canvas = document.getElementById("myCanvas");
var alien = document.getElementById("alien");
var ship = document.getElementById("ship");
var missile = document.getElementById("missile");
var ctx = canvas.getContext("2d");
var turnAround = false;
var friendlyMissileArr = [];
var enemyMissileArr = [];
var canShoot = true;
function Base(sprite, xPos, yPos){
  this.sprite = sprite;
  this.width = sprite.width;
  this.height = sprite.height;
  this.xPos = xPos;
  this.yPos = yPos;
  
  this.draw = function(){
    ctx.drawImage(this.sprite, this.xPos, this.yPos);
  }
}
function Alien(sprite, xPos, yPos){
  this.sprite = sprite;
  this.width = sprite.width;
  this.height = sprite.height;
  this.xPos = xPos;
  this.yPos = yPos;
  
  this.draw = function(){
    ctx.drawImage(this.sprite, this.xPos, this.yPos);
  }
  
  this.moveRight = function(){
    this.xPos = this.xPos + 10;
    this.draw();
  }
  
  this.moveLeft = function(){
    this.xPos = this.xPos - 10;
    this.draw();
  }
  
  this.moveDown = function(){
    this.yPos = this.yPos + 5;
    this.draw();
  }
}
function Ship(sprite, xPos, yPos){
  this.sprite = sprite;
  this.width = sprite.width;
  this.height = sprite.height;
  this.xPos = xPos;
  this.yPos = yPos;
  this.draw = function(){
    ctx.drawImage(this.sprite, this.xPos, this.yPos);
  }
}
function Missile(sprite, xPos, yPos){
  this.sprite = sprite;
  this.width = sprite.width;
  this.height = sprite.height;
  this.xPos = xPos;
  this.yPos = yPos;
  this.draw = function(){
    ctx.drawImage(this.sprite, this.xPos, this.yPos);
  }
  this.moveUp = function(){
    this.yPos = this.yPos - 1;
    this.draw();
  }
  this.moveDown = function(){
    this.yPos = this.yPos + 1;
    this.draw();
  }
  }

var alienArr = [];

for (var y = 40; y <= 164; y = y + 31)
{
  for (var x = 68; x <= 431; x = x + 33){
    alienArr.push(new Alien(alien, x, y));
  }
}



var base1 = new Base(base, 52, 380);
var base2 = new Base(base, 164, 380);
var base3 = new Base(base, 276, 380);
var base4 = new Base(base, 388, 380);

var baseArr = [base1, base2, base3, base4]
var ship = new Ship(ship, 200, 430);

window.onload = function() {

setInterval(function()

	{ 
	ctx.beginPath();
	ctx.rect(0, 0, widthBoard, lengthBoard);
	ctx.fillStyle = "black";
	ctx.fill();
	ctx.font = "30px Arial";
	ship.draw();
	canShoot = true; 
	
	
	
	
	
	
	document.onkeydown = checkKey;
	
	 function checkKey(e) {
    e = e || window.event;
    
    if (e.keyCode == '37') {
      ship.xPos = ship.xPos - 10;
    }
    else if (e.keyCode == '39') {
      ship.xPos = ship.xPos + 10;
    }
    else if (e.keyCode == '32' && canShoot == true){
      friendlyMissileArr.push(new Missile(missile, ship.xPos + ship.width / 2 - 3, ship.yPos - 10 ));
      canShoot = false;
    }
}
  
	for (var x = 0; x < baseArr.length; x++){
	  baseArr[x].draw();
	}
	
  for (var x = 0; x < alienArr.length; x++){
    var tempFurthestRight = alienArr[0].xPos;
    var tempFurthestLeft = alienArr[0].xPos;
    var tempFurthestDown = alienArr[0].yPos;
    if (alienArr[x].xPos > tempFurthestRight){
      tempFurthestRight = alienArr[x].xPos;
    }
    if (alienArr[x].xPos < tempFurthestLeft){
      tempFurthestLeft = alienArr[x].xPos;
    }
    if (alienArr[x].yPos > tempFurthestDown){
      tempFurthestDown = alienArr[x].yPos;
    }
  }
  
  for (var x = 0; x < alienArr.length; x++){
    if (tempFurthestLeft >= -8.5 && tempFurthestLeft <= 24.5){
      turnAround = true;
      alienArr[x].moveDown();
    }
    else if (tempFurthestRight >= 445 && tempFurthestRight <= 500){
      turnAround = false;
      alienArr[x].moveDown();
    }
    if (turnAround == false){
      alienArr[x].moveLeft();
    }
    else if (turnAround == true){
      alienArr[x].moveRight();
    }
    if (alienArr[x].yPos == tempFurthestDown){
      enemyMissileArr.push(new Missile(missile, alienArr[x].xPos + alienArr[x].width / 2 - 3, alienArr[x].yPos + alienArr[x].height + 10));
    }
  }



  setInterval(function()
	{ 
	  
	  ctx.fillStyle = "white";
	  ctx.fillText("Score : " + score, 0, 30);
	  ctx.fillText("Lives : " + lives, 380, 30);
	  ctx.fillStyle = "black";
	  
	   ctx.fillRect(0, base1.yPos + base1.height , 500, 120),
	   ship.draw();
	   for (var i = 0; i < friendlyMissileArr.length; i++){
      friendlyMissileArr[i].moveUp();
    }
    for (var x = 0; x < friendlyMissileArr.length; x++){
      for (var y = 0; y < alienArr.length; y++){
        if (alienArr[y].xPos <= friendlyMissileArr[x].xPos && friendlyMissileArr[x].xPos <= alienArr[y].width + alienArr[y].xPos &&
        friendlyMissileArr[x].yPos == alienArr[y].yPos + alienArr[y].height)
        {
          ctx.fillRect(alienArr[y].xPos, alienArr[y].yPos , alienArr[y].width ,alienArr[y].height);
          ctx.fillRect(friendlyMissileArr[x].xPos, friendlyMissileArr[x].yPos, friendlyMissileArr[x].width, friendlyMissileArr[x].height);
          alienArr.splice(y, 1);
          friendlyMissileArr.splice(x, 1);
          score = score + 10;
        }
      }
      
      }
    
    for (var x = 0; x < enemyMissileArr.length; x++){
      enemyMissileArr[x].moveDown();
    }
	  
	}, 1);
		
	}, 1000);




}





</script>